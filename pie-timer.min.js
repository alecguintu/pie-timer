/*
* Pie Timer
*
* A simple pie display/timer
*
* Credit goes to http://atomicnoggin.ca/blog/2010/02/20/pure-css3-pie-charts/
* Initial code from http://blakek.us/css3-pie-graph-timer-with-jquery/
* and I expanded and made into a jQuery plugin
*
* Author: Alec Guintu
* and to those the code originated.
*
* v1.0
*************************************************************************/
(function(a){a.fn.pietimer=function(c){if(b[c]){return b[c].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof c==="object"||!c){return b.init.apply(this,arguments)}else{a.error("Method "+c+" does not exist on jQuery.tooltip")}};var b={init:function(b){var c={percent:100,color:"#72B359",duration:5e3,withPercent:true,withCloser:true,closerColor:"#C8E1BE",animate:true,block:false,size:150};if(b){a.extend(c,b)}return this.each(function(){var b=a(this);if(c.animate){b.pietimer("play",c)}else{b.pietimer("draw",c)}})},draw:function(b){var c={percent:100,color:"#72B359",withPercent:true,withCloser:true,closerColor:"#C8E1BE",block:false,size:150};if(b){a.extend(c,b)}a(this).empty();a(this).css("font-size",c.size+"px");if(c.withPercent){a(this).append('<div class="percent">'+Math.round(c.percent)+"%</div>")}if(c.withCloser){a(this).append('<div class="closer"></div>')}var d=a('<div class="slice"><div class="pie"></div></div>');if(c.percent>50){d.addClass("gt50");d.append('<div class="pie fill"></div>')}var e=360/100*c.percent;d.children(".pie").css({"-moz-transform":"rotate("+e+"deg)","-webkit-transform":"rotate("+e+"deg)","-o-transform":"rotate("+e+"deg)",msTransform:"rotate("+e+"deg)",transform:"rotate("+e+"deg)"});if(c.block){a(this).addClass("fill");d.children(".pie").css("background-color",c.color);a(this).find(".closer").css("background-color",c.closerColor)}else{d.children(".pie").css("border-color",c.color);a(this).find(".closer").css("border-color",c.closerColor)}a(this).append(d)},play:function(b){var c=b.duration;var d=(new Date).getTime()+b.duration;var e=b.percent;var f=setInterval(function(){var g=d-(new Date).getTime();if(g<=0){b.percent=e;a(this).pietimer("draw",b);clearInterval(f)}else{b.percent=e-g/c*e;a(this).pietimer("draw",b)}}.bind(this),50)},stop:function(){console.log("stopping")}}})(jQuery)
